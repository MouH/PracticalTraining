package com.ambow.vsts.dao.imp;

import java.util.Collection;
import java.util.Date;
import java.util.HashSet;

import org.hibernate.Session;
import org.hibernate.Transaction;

import com.ambow.vsts.dao.UserDao;
import com.ambow.vsts.entity.User;
import com.ambow.vsts.util.HibernateUtil;

public class UserDaoHibnerateImpl extends GenericDaoHibernateImpl
	implements UserDao{


	public void addUser(User user) throws Exception {
		new GenericDaoHibernateImpl().save(user);
	}


	public Collection<User> findAll() throws Exception {
		//User user =new User();
		// TODO Auto-generated method stub
		Collection coll = getAll(new User());
		return (Collection<User>)coll;
	}
	public User getUserByName(String name){
		Collection coll = new HashSet();
		Collection co = new HashSet();
		User u = new User();
		Session session = new HibernateUtil().getSession();
		Transaction tran = session.beginTransaction();
		String hql = "from User u where u.name = '" +name+"'";
		coll = session.createQuery(hql).list();
		for(User user:(Collection<User>)coll){
			u = user;
//			System.out.println(u.getName()+","+u.getPasswd());
		}
		tran.commit();
		session.flush();
		session.close();
		return u;
	}


	public User login(String name, String passwd) {
		// TODO Auto-generated method stub
		User user = new User();
		user = new UserDaoHibnerateImpl().getUserByName(name);
		if(!user.getPasswd().isEmpty()){
			return user;
		}
		else return null;
		
	}


	public void updateUser(User user) {
		update(user);
	}
	
	public static void main(String[] args) throws Exception {
//		Date d=new Date(System.currentTimeMillis() + 30 * 60 * 1000);
//		User u1 = new User(0, "spp","1234","a@sina.com","110",new Date(1990,1,1));
//		new UserDaoHibnerateImpl().addUser(u1);
//		User u = new User();
//		System.out.println(new UserDaoHibnerateImpl().findAll());
		
//		User u = new User(); 
//		u =	 new UserDaoHibnerateImpl().getUserByName("spp");
		
	}





}
